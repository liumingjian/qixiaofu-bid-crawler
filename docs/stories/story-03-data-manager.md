# Story 03: æ•°æ®ç®¡ç†æ¨¡å—

**Story ID**: STORY-03  
**å…³è”ä»»åŠ¡**: Task 2.2  
**ä¼˜å…ˆçº§**: ğŸ”´ P0 - æœ€é«˜  
**é¢„è®¡æ—¶é•¿**: 2å°æ—¶  
**è´Ÿè´£äºº**: -  
**çŠ¶æ€**: âœ… å·²å®Œæˆ  
**ä¾èµ–**: STORY-01

---

## ğŸ“‹ Storyæè¿°

ä½œä¸ºæ•°æ®ä¸­å¿ƒæ¨¡å—ï¼Œæˆ‘éœ€è¦å®ç°æ–‡ç« å’Œæ‹›æ ‡ä¿¡æ¯çš„JSONæ–‡ä»¶å­˜å‚¨ã€å»é‡ã€æŸ¥è¯¢åŠŸèƒ½ï¼Œç¡®ä¿æ•°æ®æŒä¹…åŒ–å’Œä¸€è‡´æ€§ã€‚

---

## ğŸ¯ éªŒæ”¶æ ‡å‡†

- [x] JSONæ–‡ä»¶è¯»å†™æ­£å¸¸
- [x] å»é‡é€»è¾‘æ­£ç¡®(æ–‡ç« URLã€æ‹›æ ‡ID)
- [x] æ”¯æŒçŠ¶æ€è¿‡æ»¤æŸ¥è¯¢(new/notified/archived)
- [x] æ–‡ä»¶å¼‚å¸¸æœ‰é”™è¯¯å¤„ç†å’Œå¤‡ä»½æœºåˆ¶
- [x] å•å…ƒæµ‹è¯•è¦†ç›–ç‡ â‰¥ 80%

---

## âœ… TODOæ¸…å•

### 1. åˆ›å»ºæ–‡ä»¶å­˜å‚¨ç±» (30åˆ†é’Ÿ)
- [x] åˆ›å»º `storage/file_storage.py` æ–‡ä»¶
- [x] å®ç° `FileStorage` ç±»
- [x] å®ç° `load_json()` æ–¹æ³•:
  - [x] è¯»å–JSONæ–‡ä»¶
  - [x] æ–‡ä»¶ä¸å­˜åœ¨è¿”å›ç©ºåˆ—è¡¨
  - [x] JSONè§£æé”™è¯¯è¿”å›ç©ºåˆ—è¡¨å¹¶è®°å½•æ—¥å¿—/éš”ç¦»æŸåæ–‡ä»¶
- [x] å®ç° `save_json()` æ–¹æ³•:
  - [x] ä¿å­˜å‰å¤‡ä»½åŸæ–‡ä»¶
  - [x] å†™å…¥JSON(æ ¼å¼åŒ–ç¼©è¿›)
  - [x] å†™å…¥å¤±è´¥æ¢å¤å¤‡ä»½
- [x] å®ç° `backup_file()` / `_cleanup_old_backups()` æ–¹æ³•:
  - [x] å¤‡ä»½æ–‡ä»¶åŠ æ—¶é—´æˆ³
  - [x] ä¿ç•™æœ€è¿‘3ä¸ªå¤‡ä»½
- [x] æ·»åŠ æ—¥å¿—è®°å½•

### 2. åˆ›å»ºæ•°æ®ç®¡ç†ç±» (45åˆ†é’Ÿ)
- [x] åˆ›å»º `core/data_manager.py` æ–‡ä»¶
- [x] å®ç° `DataManager` ç±»
- [x] åœ¨ `__init__()` ä¸­:
  - [x] åŠ è½½é…ç½®å¹¶è§£ææ•°æ®ã€æ—¥å¿—ç›®å½•
  - [x] åˆå§‹åŒ– `FileStorage`
  - [x] è®¾ç½®æ–‡ç« å’Œæ‹›æ ‡æ–‡ä»¶è·¯å¾„
  - [x] åˆå§‹åŒ–logger

### 3. å®ç°æ‹›æ ‡ä¿¡æ¯ç®¡ç† (30åˆ†é’Ÿ)
- [x] å®ç° `save_bids()` æ–¹æ³•(å»é‡+è¿”å›æ–°å¢)
- [x] å®ç° `get_all_bids()` æ–¹æ³•(çŠ¶æ€è¿‡æ»¤+æ—¶é—´æ’åº)
- [x] å®ç° `update_bid_status()` æ–¹æ³•(çŠ¶æ€æ›´æ–°+æ—¶é—´æˆ³)

### 4. å®ç°æ–‡ç« ç®¡ç† (20åˆ†é’Ÿ)
- [x] å®ç° `is_article_crawled()` æ–¹æ³•
- [x] å®ç° `save_article()` æ–¹æ³•(URLå»é‡+å…ƒæ•°æ®ä¿å­˜)
- [x] å®ç° `get_all_articles()` æ–¹æ³•

### 5. å®ç°ç»Ÿè®¡åŠŸèƒ½ (15åˆ†é’Ÿ)
- [x] å®ç° `get_stats()` æ–¹æ³•(æ–‡ç« /æ‹›æ ‡æ€»é‡+çŠ¶æ€æ‹†åˆ†)

### 6. ç¼–å†™å•å…ƒæµ‹è¯• (30åˆ†é’Ÿ)
- [x] åˆ›å»º `tests/test_data_manager.py`
- [x] æ–‡ä»¶å­˜å‚¨è¯»å–/å¤‡ä»½/æŸåéš”ç¦»æµ‹è¯•
- [x] æ‹›æ ‡å»é‡ã€çŠ¶æ€è¿‡æ»¤/æ›´æ–°æµ‹è¯•
- [x] æ–‡ç« å»é‡ã€å·²çˆ¬æ£€æŸ¥æµ‹è¯•
- [x] ç»Ÿè®¡ç»“æœæµ‹è¯•
- [x] ä½¿ç”¨ä¸´æ—¶ç›®å½•+ç‹¬ç«‹é…ç½®ï¼Œæ¸…ç†æ—¥å¿—å¥æŸ„

---

## ğŸ“¦ äº¤ä»˜ç‰©

- [x] `storage/file_storage.py`
- [x] `core/data_manager.py`
- [x] `tests/test_data_manager.py`
- [x] æµ‹è¯•æ•°æ®ä¸å¤‡ä»½æ–‡ä»¶æ ·ä¾‹

---

## ğŸ§ª æµ‹è¯•æ¸…å•

- [x] JSONè¯»å†™ä¸æŸåæ–‡ä»¶éš”ç¦»
- [x] å¤‡ä»½/æ¢å¤/å†å²æ¸…ç†é€»è¾‘
- [x] æ‹›æ ‡å»é‡ä¸çŠ¶æ€è¿‡æ»¤
- [x] æ‹›æ ‡çŠ¶æ€æ›´æ–°
- [x] æ–‡ç« URLå»é‡
- [x] ç»Ÿè®¡æ¥å£
- [x] å•å…ƒæµ‹è¯•(`python -m unittest tests.test_data_manager -v`)é€šè¿‡

---

## âœ¨ å®Œæˆæ ‡å‡†

- [x] å•å…ƒæµ‹è¯•å…¨éƒ¨é€šè¿‡
- [x] æ‰‹åŠ¨æ‰§è¡Œ `DataManager` ç¤ºä¾‹éªŒè¯æ–°å¢/æŸ¥è¯¢/ç»Ÿè®¡é“¾è·¯

ç¤ºä¾‹:
```python
from core.data_manager import DataManager
manager = DataManager()
new_bids = manager.save_bids([{'id': 'demo', 'project_name': 'Demo', 'budget': '10ä¸‡å…ƒ', 'purchaser': 'Demo', 'doc_time': '2025-11-25'}])
print('New bids:', len(new_bids))
print('Stats:', manager.get_stats())
```

---

## ğŸ“… æ—¶é—´è®°å½•

- **å¼€å§‹æ—¶é—´**: 2025-11-25 22:45
- **å®Œæˆæ—¶é—´**: 2025-11-25 23:00
- **å®é™…è€—æ—¶**: 0.5å°æ—¶
- **å¤‡æ³¨**: å®ŒæˆFileStorageå†—ä½™ä¿æŠ¤ã€DataManager CRUD/ç»Ÿè®¡ä¸å•å…ƒæµ‹è¯•ã€‚
